{"version":3,"sources":["../lib/Directory.jsx"],"names":["Directory","props","scrollToSelect","node","index","window","scrollTo","offsetTop","id","cur","document","getElementById","setState","top","console","log","isActive","nextNode","current","state","precent","next","directoryScroll","_defaultType","rule","customStyle","directory","onscroll","win","Array","isArray","defaultStyle","fontSize","fontWeight","textAlign","map","item","type","tagIndex","bind","text","Component"],"mappings":"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","file":"Directory.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { getDirectory, getScrollTop, ScrollToAnimate } from \"./utils\";\r\nimport { HashRouter, NavLink } from \"react-router-dom\";\r\nimport './style.css';\r\nexport default class Directory extends Component{\r\n  constructor(props) {\r\n    super(props);\r\n    // this.top = 22;\r\n    this._defaultType=true;\r\n    this.rule = this.props.rule||['h1','h2','h3'];\r\n    this.customStyle = this.props.customStyle||{};\r\n    this.state={\r\n      directory:[],\r\n      current:0,\r\n      top:22,\r\n    }\r\n    window.onscroll=()=>{\r\n      this.setState({ \r\n        current: getScrollTop(),\r\n      });\r\n      \r\n    }\r\n  }\r\n  componentDidMount(){\r\n    this.setState({ directory: getDirectory(this.props.directory, this.rule)});\r\n  }\r\n  scrollToSelect = (node,index) => {\r\n    window.scrollTo(0, node && node.offsetTop);\r\n    let id = \"directory-default\" + index;\r\n    let cur = document.getElementById(id);\r\n    if (cur) {\r\n      // this.top = cur.offsetTop;\r\n      this.setState({top:cur.offsetTop});\r\n      console.log('cur',cur.offsetTop);\r\n      \r\n    }\r\n  };\r\n  directoryScroll(index) {\r\n    let id = \"directory-default\" + index;\r\n    let cur = document.getElementById(id);\r\n    let win = document.getElementById(\"main-default\");\r\n    if (cur&&win) {\r\n      // this.setState({ top: cur.offsetTop });\r\n      this.top = cur.offsetTop;\r\n      //this.forceUpdate();\r\n      console.log('bianhua',cur.offsetTop);\r\n      win.scrollTo(0, cur.offsetTop - 68);\r\n    }\r\n  }\r\n  isActive = (index, node, nextNode) => {\r\n    const { current } = this.state;\r\n    if (node && nextNode) {\r\n      let precent = node.offsetTop ;\r\n      let next = nextNode.offsetTop||current+1;\r\n      if (index === 0 && current <= precent) {\r\n        return true;\r\n      } else if (precent <= current && next > current) {\r\n        this.directoryScroll(index);\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n  render(){\r\n    console.log('sss', this.state.top);\r\n    // this.rule={h1:{},h2:{},h3:{}}\r\n    if (!Array.isArray(this.rule)) {\r\n      this._defaultType=false;\r\n    }\r\n    let defaultStyle=['first','second','third','fourth'];\r\n    return (\r\n      <div className=\"main-default\" id=\"main-default\" style={this.customStyle}>\r\n        <div style={{ fontSize: \"16px\", fontWeight: 700, textAlign: 'center' }}>目录</div>\r\n        {/* <div className=\"directory-active\" style={{top:this.state.top}}/> */}\r\n        {/* <span style={{ fontWeight: 700 }}>{content.title}</span> */}\r\n        {this.state.directory && this.state.directory.map((item, index) => (\r\n          <HashRouter key={index}>\r\n            <NavLink\r\n              style={this._defaultType ? {} : this.rule[item.type]}\r\n              className={'directory-default directory-default-' + defaultStyle[item.tagIndex] + \" directory-\" + item.type}\r\n              isActive={this.isActive.bind(this, index, item.node, item.nextNode)}\r\n              id={'directory-default' + index}\r\n              activeClassName={'directory-active'}\r\n              to={`/header${index}`}\r\n              onClick={this.scrollToSelect.bind(null, item.node,index)}\r\n            >\r\n              {item.text}\r\n            </NavLink>\r\n          </HashRouter>\r\n          ))}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}